# M7: Windows + Mobile (iOS + Android)

## Goal

Full platform coverage. Primarily CI/build targets -- the Dart logic is
identical to desktop (M5). The work is cross-compilation and platform
bundling.

## Deliverables

- Windows support in `dart_monty_desktop`
- `packages/dart_monty_mobile` for iOS and Android

## Work Items

### 7.1 Windows

- [ ] CI: Rust build for `x86_64-pc-windows-msvc`
- [ ] `dart_monty_native.dll`
- [ ] `windows/CMakeLists.txt`
- [ ] `DynamicLibrary.open` path handling for Windows
- [ ] Automated test on `windows-latest` CI

### 7.2 iOS

- [ ] Rust cross-compile: `aarch64-apple-ios`, `aarch64-apple-ios-sim`
- [ ] Static library (`.a`) + XCFramework
- [ ] `dart_monty_mobile.podspec` with vendored framework
- [ ] CI: iOS simulator test

### 7.3 Android

- [ ] Rust via cargo-ndk: `arm64-v8a`, `armeabi-v7a`, `x86_64`
- [ ] `.so` per ABI in `jniLibs/`
- [ ] Gradle integration
- [ ] CI: Android emulator test

### 7.4 Automated Tests

- [ ] `tool/test_windows.sh` -- build + flutter test on Windows
- [ ] `tool/test_ios.sh` -- build + flutter test on iOS simulator
- [ ] `tool/test_android.sh` -- build + flutter test on Android emulator
- [ ] Same Dart test suite as M5 (Isolate, lifecycle, callbacks)

## Quality Gate

```bash
# Each platform:
flutter test --coverage
# Coverage must be >= 90%
flutter analyze --fatal-infos
dart format --set-exit-if-changed .
```

## Test Dependencies

| Tool | Purpose |
|------|---------|
| Flutter SDK | Plugin framework |
| Rust cross-compile targets | Native binaries |
| `cargo-ndk` | Android NDK builds |
| Xcode | iOS builds |
| Windows CI runner | Windows builds |
